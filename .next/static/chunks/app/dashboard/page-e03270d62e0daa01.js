(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{1709:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var a=t(5155),r=t(2115),l=t(5695),n=t(2108),i=t(9137),c=t.n(i),o=t(351);function d(e){let{onSuccess:s}=e,t=(0,l.useRouter)(),[n,i]=(0,r.useState)(""),[d,m]=(0,r.useState)(""),[x,b]=(0,r.useState)(""),[u,h]=(0,r.useState)(!1),[f,p]=(0,r.useState)(!1),[j,y]=(0,r.useState)(""),[g,N]=(0,r.useState)(null),[w,v]=(0,r.useState)([]),k=async()=>{if(!n.includes("docs.google.com/spreadsheets")){y("Please enter a valid Google Sheets URL");return}h(!0),y("");try{let e=await fetch("/api/sheets/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetUrl:n})}),s=await e.json();if(!e.ok)throw Error(s.message||"Failed to preview sheet");v(s.columns||[]),N(s.preview||[])}catch(e){e instanceof Error?y(e.message):y("Failed to preview sheet")}finally{h(!1)}},S=async e=>{if(e.preventDefault(),!n||!d){y("Please provide a Google Sheet URL and select a column");return}p(!0),y("");try{let e=await fetch("/api/jobs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheetUrl:n,columnName:d,jobName:x||"".concat(d," extraction")})}),a=await e.json();if(!e.ok)throw Error(a.error||"Failed to create job");console.log("Job created successfully:",a),s?s():t.push("/dashboard/results/".concat(a.job.id))}catch(e){console.error("Error creating job:",e),y(e instanceof Error?e.message:"Failed to create job")}finally{p(!1)}};return(0,a.jsxs)("div",{className:"jsx-8784a5c2339b6fba bg-white/90 backdrop-blur-sm shadow-xl rounded-2xl overflow-hidden border border-gray-100 relative z-10",children:[(0,a.jsxs)("div",{className:"jsx-8784a5c2339b6fba p-8",children:[j&&(0,a.jsxs)("div",{className:"jsx-8784a5c2339b6fba mb-6 p-4 bg-red-50 border-l-4 border-red-400 text-red-700 rounded-lg text-sm flex items-start animate-fade-in",children:[(0,a.jsx)(o.y3G,{className:"mr-2 mt-0.5 flex-shrink-0"}),(0,a.jsx)("span",{className:"jsx-8784a5c2339b6fba",children:j})]}),(0,a.jsxs)("form",{onSubmit:S,className:"jsx-8784a5c2339b6fba space-y-6",children:[(0,a.jsxs)("div",{className:"jsx-8784a5c2339b6fba",children:[(0,a.jsxs)("label",{htmlFor:"sheetUrl",className:"jsx-8784a5c2339b6fba block text-sm font-medium text-gray-700 mb-2 flex items-center",children:[(0,a.jsx)("div",{className:"jsx-8784a5c2339b6fba w-6 h-6 bg-primary/10 text-primary rounded-md flex items-center justify-center mr-2",children:(0,a.jsx)(o.ayE,{size:14})}),"Google Sheet URL"]}),(0,a.jsxs)("div",{className:"jsx-8784a5c2339b6fba mt-1",children:[(0,a.jsx)("div",{className:"jsx-8784a5c2339b6fba relative group",children:(0,a.jsx)("input",{id:"sheetUrl",name:"sheetUrl",type:"text",required:!0,value:n,onChange:e=>{i(e.target.value),N(null),v([]),m("")},placeholder:"https://docs.google.com/spreadsheets/d/...",className:"jsx-8784a5c2339b6fba block w-full px-4 py-3 border border-gray-200 rounded-xl text-gray-900 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all bg-white/70 backdrop-blur-sm"})}),(0,a.jsxs)("p",{className:"jsx-8784a5c2339b6fba mt-2 text-xs text-gray-500 flex items-center ml-1",children:[(0,a.jsx)(o.S8s,{className:"mr-1.5 text-primary/60",size:12}),'Make sure your Google Sheet is shared with "Anyone with the link can view"']})]})]}),(0,a.jsx)("div",{className:"jsx-8784a5c2339b6fba flex justify-start",children:(0,a.jsx)("button",{type:"button",onClick:k,disabled:u||!n,className:"jsx-8784a5c2339b6fba "+"py-2.5 px-5 rounded-xl flex items-center font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 transition-all shadow-sm ".concat(u||!n?"bg-gray-100 text-gray-500 cursor-not-allowed":"bg-white text-primary border border-primary/20 hover:bg-primary/5 focus:ring-primary/40"),children:u?(0,a.jsxs)("span",{className:"jsx-8784a5c2339b6fba flex items-center",children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"jsx-8784a5c2339b6fba animate-spin -ml-1 mr-2 h-4 w-4 text-primary",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",className:"jsx-8784a5c2339b6fba opacity-25"}),(0,a.jsx)("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",className:"jsx-8784a5c2339b6fba opacity-75"})]}),"Loading..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.CKj,{className:"mr-2"}),"Preview Sheet"]})})}),w.length>0&&(0,a.jsxs)("div",{className:"jsx-8784a5c2339b6fba mt-6",children:[(0,a.jsx)("label",{htmlFor:"columnName",className:"jsx-8784a5c2339b6fba block text-sm font-medium text-gray-700 mb-2",children:(0,a.jsxs)("div",{className:"jsx-8784a5c2339b6fba flex items-center",children:[(0,a.jsx)(o.SWv,{className:"text-gray-400 mr-2"}),(0,a.jsx)("span",{className:"jsx-8784a5c2339b6fba",children:"Select Column with Website URLs"})]})}),(0,a.jsxs)("select",{id:"columnName",value:d,onChange:e=>m(e.target.value),className:"jsx-8784a5c2339b6fba block w-full pl-3 pr-10 py-2.5 text-base border border-gray-300 focus:outline-none focus:ring-primary/20 focus:border-primary sm:text-sm rounded-lg",children:[(0,a.jsx)("option",{value:"",className:"jsx-8784a5c2339b6fba",children:"-- Select a column --"}),w.map(e=>(0,a.jsx)("option",{value:e,className:"jsx-8784a5c2339b6fba",children:e},e))]})]}),d&&(0,a.jsxs)("div",{className:"jsx-8784a5c2339b6fba mt-6",children:[(0,a.jsx)("label",{htmlFor:"jobName",className:"jsx-8784a5c2339b6fba block text-sm font-medium text-gray-700 mb-2",children:(0,a.jsxs)("div",{className:"jsx-8784a5c2339b6fba flex items-center",children:[(0,a.jsx)(o.cnX,{className:"text-gray-400 mr-2"}),(0,a.jsx)("span",{className:"jsx-8784a5c2339b6fba",children:"Job Name (Optional)"})]})}),(0,a.jsx)("input",{id:"jobName",type:"text",value:x,onChange:e=>b(e.target.value),placeholder:"".concat(d," extraction"),className:"jsx-8784a5c2339b6fba block w-full pl-3 pr-3 py-2.5 text-base border border-gray-300 focus:outline-none focus:ring-primary/20 focus:border-primary sm:text-sm rounded-lg"}),(0,a.jsx)("p",{className:"jsx-8784a5c2339b6fba mt-1 text-xs text-gray-500",children:"Give this job a name to easily identify it later"})]}),g&&g.length>0&&(0,a.jsxs)("div",{className:"jsx-8784a5c2339b6fba pt-6 border-t border-gray-100",children:[(0,a.jsxs)("h3",{className:"jsx-8784a5c2339b6fba text-sm font-medium text-gray-700 mb-3 flex items-center",children:[(0,a.jsx)("div",{className:"jsx-8784a5c2339b6fba w-6 h-6 bg-primary/10 text-primary rounded-md flex items-center justify-center mr-2",children:(0,a.jsx)(o.HaR,{size:14})}),"Total Websites: ",g.length]}),(0,a.jsx)("div",{className:"jsx-8784a5c2339b6fba bg-white/70 backdrop-blur-sm rounded-xl overflow-hidden border border-gray-200 shadow-sm p-4",children:(0,a.jsxs)("p",{className:"jsx-8784a5c2339b6fba text-sm text-gray-600",children:["The system will process ",g.length," website",1!==g.length?"s":""," from the selected column.",(0,a.jsx)("br",{className:"jsx-8784a5c2339b6fba"}),"Each website will be analyzed for contact emails."]})})]}),(0,a.jsx)("div",{className:"jsx-8784a5c2339b6fba pt-6 border-t border-gray-100",children:(0,a.jsx)("button",{type:"submit",disabled:f||!n||!d,className:"jsx-8784a5c2339b6fba "+"w-full py-3 px-4 rounded-xl flex items-center justify-center font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary/50 transition-all shadow-md ".concat(!f&&n&&d?"bg-gradient-to-r from-primary to-indigo-600 text-white hover:shadow-lg":"bg-gradient-to-r from-primary/60 to-indigo-500/60 text-white cursor-not-allowed"),children:f?(0,a.jsxs)("span",{className:"jsx-8784a5c2339b6fba flex items-center",children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"jsx-8784a5c2339b6fba animate-spin -ml-1 mr-2 h-4 w-4 text-white",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",className:"jsx-8784a5c2339b6fba opacity-25"}),(0,a.jsx)("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",className:"jsx-8784a5c2339b6fba opacity-75"})]}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"jsx-8784a5c2339b6fba",children:"Start Scraping Job"}),(0,a.jsx)("div",{className:"jsx-8784a5c2339b6fba ml-2 p-1 bg-white/20 rounded-full",children:(0,a.jsx)(o.dyV,{size:16,className:"group-hover:translate-x-1 transition-transform"})})]})})})]})]}),(0,a.jsx)(c(),{id:"8784a5c2339b6fba",children:"@-webkit-keyframes fade-in{from{opacity:0;-webkit-transform:translatey(-10px);transform:translatey(-10px)}to{opacity:1;-webkit-transform:translatey(0);transform:translatey(0)}}@-moz-keyframes fade-in{from{opacity:0;-moz-transform:translatey(-10px);transform:translatey(-10px)}to{opacity:1;-moz-transform:translatey(0);transform:translatey(0)}}@-o-keyframes fade-in{from{opacity:0;-o-transform:translatey(-10px);transform:translatey(-10px)}to{opacity:1;-o-transform:translatey(0);transform:translatey(0)}}@keyframes fade-in{from{opacity:0;-webkit-transform:translatey(-10px);-moz-transform:translatey(-10px);-o-transform:translatey(-10px);transform:translatey(-10px)}to{opacity:1;-webkit-transform:translatey(0);-moz-transform:translatey(0);-o-transform:translatey(0);transform:translatey(0)}}.animate-fade-in{-webkit-animation:fade-in.3s ease-out forwards;-moz-animation:fade-in.3s ease-out forwards;-o-animation:fade-in.3s ease-out forwards;animation:fade-in.3s ease-out forwards}"})]})}var m=t(9923),x=t(6874),b=t.n(x);function u(){var e,s;let{data:i,status:c}=(0,n.useSession)(),x=(0,l.useRouter)(),u=(0,l.useSearchParams)().get("tab"),[h,p]=(0,r.useState)("jobs"===u?"jobs":"new"),[j,y]=(0,r.useState)([]),[g,N]=(0,r.useState)(!1),[w,v]=(0,r.useState)(null),[k,S]=(0,r.useState)(!0),E=(0,r.useRef)(null),[C,z]=(0,r.useState)([]);(0,r.useEffect)(()=>{let e="jobs"===h?"/dashboard?tab=jobs":"/dashboard";window.history.replaceState(null,"",e)},[h]);let U=async e=>{try{z(s=>[...s,e]);let s=await fetch("/api/jobs/".concat(e));if(!s.ok)throw Error("Failed to fetch job: ".concat(s.status));let t=await s.json();if(t.job)return y(s=>s.map(s=>s.id===e?t.job:s)),t.job;return null}catch(s){return console.error("Error refreshing job ".concat(e,":"),s),null}finally{z(s=>s.filter(s=>s!==e))}},F=async()=>{N(!0);try{try{let{loadJobsFromDatabase:e}=await Promise.all([t.e(267),t.e(109)]).then(t.bind(t,3109));console.log("Reloading jobs from database..."),await e()}catch(e){console.error("Error reloading from database:",e)}let e=await fetch("/api/jobs");if(!e.ok)throw Error("Failed to fetch jobs: ".concat(e.status));let s=await e.json();if(console.log("Refreshed jobs:",s),s.jobs&&Array.isArray(s.jobs)){let e=s.jobs.map(e=>e.id);localStorage.setItem("userJobIds",JSON.stringify(e))}return y(s.jobs||[]),s.jobs||[]}catch(e){return console.error("Error fetching jobs:",e),v("Failed to load jobs. Please try again."),[]}finally{N(!1)}},P=async e=>{y(s=>s.filter(s=>s.id!==e))};return((0,r.useEffect)(()=>((async function(){N(!0);try{localStorage.getItem("userJobIds");let{loadJobsFromDatabase:e}=await Promise.all([t.e(267),t.e(109)]).then(t.bind(t,3109));await e(),await F()}catch(e){console.error("Error loading jobs in dashboard:",e),v("Failed to load jobs. Please try again.")}finally{N(!1)}})(),()=>{E.current&&clearInterval(E.current)}),[]),(0,r.useEffect)(()=>(E.current&&(clearInterval(E.current),E.current=null),k&&(E.current=setInterval(()=>{"jobs"===h&&j.length>0&&j.forEach(e=>{"processing"===e.status&&U(e.id)})},5e3)),()=>{E.current&&clearInterval(E.current)}),[k,h,j]),i)?(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100",children:[(0,a.jsx)("header",{className:"bg-white/80 backdrop-blur-md shadow-sm border-b border-slate-100 sticky top-0 z-10",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"bg-primary-50 p-2 rounded-full text-primary-600 mr-3",children:(0,a.jsx)(o.pHD,{className:"text-xl"})}),(0,a.jsx)("h1",{className:"text-xl font-bold text-slate-800",children:"FunnelStrike Email Scraper"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)(b(),{href:"/",className:"flex items-center text-sm bg-white py-2 px-4 rounded-full border border-slate-200 text-slate-700 hover:bg-slate-50 transition-colors shadow-sm",children:[(0,a.jsx)(o.V5Y,{className:"mr-2 text-primary-600"}),"Home"]}),(0,a.jsxs)("div",{className:"flex items-center text-sm bg-white py-2 px-4 rounded-full border border-slate-200 shadow-sm",children:[(0,a.jsx)(o.JXP,{className:"mr-2 text-primary-600"}),(0,a.jsx)("span",{className:"font-medium text-slate-700 truncate max-w-[200px]",children:(null===(e=i.user)||void 0===e?void 0:e.name)||(null===(s=i.user)||void 0===s?void 0:s.email)})]}),(0,a.jsxs)("button",{onClick:()=>x.push("/api/auth/signout"),className:"flex items-center text-sm bg-white py-2 px-4 rounded-full border border-slate-200 text-slate-700 hover:bg-slate-50 transition-colors shadow-sm",children:[(0,a.jsx)(o.QeK,{className:"mr-2 text-red-500"}),"Sign out"]})]})]})})}),(0,a.jsx)("main",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:(0,a.jsx)(m.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mb-8",children:(0,a.jsxs)("div",{className:"bg-white/80 backdrop-blur-sm shadow-md rounded-xl overflow-hidden border border-slate-200",children:[(0,a.jsxs)("div",{className:"flex border-b border-slate-100 bg-slate-50/50 p-1.5 gap-1.5",children:[(0,a.jsxs)("button",{onClick:()=>p("new"),className:"flex items-center py-2.5 px-5 text-sm font-medium rounded-lg transition-all ".concat("new"===h?"bg-white text-primary-600 shadow-sm":"text-slate-600 hover:bg-white/80 hover:text-slate-900"),children:[(0,a.jsx)(o.E1u,{className:"mr-2 ".concat("new"===h?"text-primary-600":"text-slate-400")}),"New Extraction"]}),(0,a.jsxs)("button",{onClick:()=>p("jobs"),className:"flex items-center py-2.5 px-5 text-sm font-medium rounded-lg transition-all ".concat("jobs"===h?"bg-white text-primary-600 shadow-sm":"text-slate-600 hover:bg-white/80 hover:text-slate-900"),children:[(0,a.jsx)(o.Wm,{className:"mr-2 ".concat("jobs"===h?"text-primary-600":"text-slate-400")}),"My Jobs"]})]}),(0,a.jsx)("div",{className:"p-6",children:"new"===h?(0,a.jsx)(m.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,a.jsx)(d,{onSuccess:()=>{p("jobs"),F()}})}):(0,a.jsx)(m.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,a.jsx)(f,{jobs:j,loading:g,error:w,onRefresh:F,onDelete:P,onRefreshJob:U,refreshingJobs:C})})})]})})}),(0,a.jsx)("footer",{className:"border-t border-slate-200 bg-white/30 backdrop-blur-sm mt-auto",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto py-4 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"text-xs text-slate-500",children:["\xa9 ",new Date().getFullYear()," FunnelStrike. All rights reserved."]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("div",{className:"text-xs text-slate-500 flex items-center",children:[(0,a.jsx)(o.Ohp,{className:"mr-1"})," Last updated: ",new Date().toLocaleDateString()]}),(0,a.jsxs)("button",{onClick:()=>S(!k),className:"flex items-center text-xs py-1 px-2 rounded ".concat(k?"bg-green-50 text-green-700":"bg-slate-50 text-slate-700"),children:[(0,a.jsx)(o.jTZ,{className:"mr-1 ".concat(k?"text-green-600":"text-slate-600"),size:12}),k?"Auto-refresh on":"Auto-refresh off"]})]})]})})})]}):null}function h(){return(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gradient-to-b from-slate-50 to-slate-100",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-slate-600 font-medium",children:"Loading dashboard..."})]})})}let f=e=>{let{jobs:s,loading:t,error:l,onRefresh:n,onDelete:i,onRefreshJob:c,refreshingJobs:d}=e,[m,x]=(0,r.useState)(!1),[u,h]=(0,r.useState)([]),[f,p]=(0,r.useState)(null),j=async()=>{x(!0);try{let e=await n();return console.log("Manually refreshed jobs:",e),e}catch(e){return console.error("Error refreshing jobs:",e),[]}finally{x(!1)}},y=async e=>{try{let s=await c(e);return console.log("Refreshed single job:",s),s}catch(s){return console.error("Error refreshing job ".concat(e,":"),s),null}},g=async e=>{if(confirm("Are you sure you want to delete this job?"))try{h(s=>[...s,e]),p(null);let s=await fetch("/api/jobs/".concat(e),{method:"DELETE"});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to delete job: ".concat(s.status))}return await i(e),console.log("Successfully deleted job ".concat(e)),e}catch(e){console.error("Error deleting job:",e),p("Failed to delete job: ".concat(e.message||"Unknown error"))}finally{h(s=>s.filter(s=>s!==e))}return null};if((0,r.useEffect)(()=>{f&&p(null)},[s]),t&&!m)return(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"animate-pulse flex justify-center mb-3",children:(0,a.jsx)(o.TwU,{className:"text-primary-500 text-2xl"})}),(0,a.jsx)("p",{className:"text-slate-600",children:"Loading your jobs..."})]});if(l)return(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"flex justify-center mb-3 text-red-500",children:(0,a.jsx)(o.y3G,{className:"text-2xl"})}),(0,a.jsx)("p",{className:"text-slate-600",children:l})]});if(!s||0===s.length)return(0,a.jsxs)("div",{className:"p-8 text-center",children:[(0,a.jsx)("div",{className:"flex justify-center mb-3 text-slate-400",children:(0,a.jsx)(o._Y7,{className:"text-3xl"})}),(0,a.jsx)("p",{className:"text-slate-600 mb-2",children:"No jobs found"}),(0,a.jsx)("p",{className:"text-slate-500 text-sm",children:"Create a new job to get started"})]});let N=e=>{switch(e){case"completed":return(0,a.jsx)(o.A3x,{className:"text-emerald-500",size:16});case"processing":return(0,a.jsx)(o.TwU,{className:"text-blue-500 animate-spin",size:16});case"pending":return(0,a.jsx)(o.Ohp,{className:"text-amber-500",size:16});case"failed":return(0,a.jsx)(o.y3G,{className:"text-red-500",size:16});default:return(0,a.jsx)(o.S8s,{className:"text-gray-500",size:16})}},w=e=>{switch(e){case"completed":return"Completed";case"processing":return"Processing";case"pending":return"Pending";case"failed":return"Failed";default:return"Unknown"}},v=e=>{if("processing"!==e.status||0===(e.processedUrls||e.processedWebsites))return null;let s=new Date(e.createdAt).getTime(),t=new Date().getTime(),a=e.processedUrls||e.processedWebsites||0,r=a/((t-s)/1e3);if(r<.001)return"Calculating...";let l=((e.totalUrls||e.totalWebsites||1)-a)/r;if(l<60)return"Less than a minute";if(l<3600){let e=Math.round(l/60);return"~".concat(e," minute").concat(e>1?"s":"")}{let e=Math.floor(l/3600),s=Math.round(l%3600/60);return"~".concat(e," hour").concat(e>1?"s":""," ").concat(s>0?"".concat(s," min"):"")}};return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-slate-800",children:"Your Extraction Jobs"}),(0,a.jsxs)("button",{onClick:j,className:"flex items-center space-x-2 bg-primary-50 hover:bg-primary-100 text-primary-700 py-2 px-3 rounded-md transition-colors text-sm",disabled:m,children:[(0,a.jsx)(o.jTZ,{className:"mr-1 ".concat(m?"animate-spin":"")}),(0,a.jsx)("span",{children:m?"Refreshing...":"Refresh"})]})]}),f&&(0,a.jsxs)("div",{className:"mb-4 bg-red-50 text-red-700 p-3 rounded-md flex items-center",children:[(0,a.jsx)(o.y3G,{className:"mr-2"}),(0,a.jsx)("span",{children:f}),(0,a.jsx)("button",{className:"ml-auto text-red-500 hover:text-red-700",onClick:()=>p(null),children:(0,a.jsx)(o.yGN,{})})]}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-slate-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Job Details"}),(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Progress"}),(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Created"}),(0,a.jsx)("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-slate-100",children:s.map(e=>{let s=d.includes(e.id),t=u.includes(e.id);return(0,a.jsxs)("tr",{className:"hover:bg-slate-50/50 transition-colors ".concat(s?"bg-slate-50/30":""," ").concat(t?"opacity-50 bg-red-50/10":""),children:[(0,a.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center",children:[t?(0,a.jsx)(o.IXo,{className:"text-red-500 animate-pulse",size:16}):s?(0,a.jsx)(o.TwU,{className:"text-blue-500 animate-spin",size:16}):N(e.status||"pending"),(0,a.jsx)("span",{className:"ml-2 text-sm text-slate-700",children:t?"Deleting...":s?"Updating...":w(e.status||"pending")})]})}),(0,a.jsx)("td",{className:"px-4 py-4",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)(b(),{href:"/dashboard/results/".concat(e.id),className:"text-sm text-slate-900 mb-1 font-medium hover:text-primary-600",children:e.name||"".concat(e.columnName," extraction")}),(0,a.jsxs)("span",{className:"text-xs text-slate-500",children:["Column: ",e.columnName]})]})}),(0,a.jsx)("td",{className:"px-4 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between text-xs text-slate-500 mb-1",children:[(0,a.jsxs)("span",{children:[e.processedUrls||e.processedWebsites||0," of ",e.totalUrls||e.totalWebsites||0]}),(0,a.jsxs)("span",{children:[(e.totalUrls||e.totalWebsites)>0?Math.round((e.processedUrls||e.processedWebsites||0)/(e.totalUrls||e.totalWebsites||1)*100):0,"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-slate-200 rounded-full h-1.5",children:(0,a.jsx)("div",{className:"h-1.5 rounded-full ".concat(t?"bg-red-500":s?"bg-blue-500":"bg-primary-600"),style:{width:"".concat((e.totalUrls||e.totalWebsites)>0?Math.round((e.processedUrls||e.processedWebsites||0)/(e.totalUrls||e.totalWebsites||1)*100):0,"%")}})}),("processing"===e.status||s)&&!t&&(0,a.jsxs)("div",{className:"mt-1 text-xs text-blue-600 flex items-center",children:[(0,a.jsx)(o.Ohp,{className:"mr-1",size:12}),(0,a.jsxs)("span",{children:["ETA: ",v(e)||"Calculating..."]})]})]})}),(0,a.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-slate-500",children:new Date(e.createdAt).toLocaleString()}),(0,a.jsx)("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(b(),{href:"/dashboard/results/".concat(e.id),className:"text-primary-600 hover:text-primary-800 ".concat(t?"pointer-events-none opacity-50":""),children:[(0,a.jsx)(o.CKj,{size:16,className:"inline mr-1"})," View"]}),"completed"===e.status&&!t&&(0,a.jsxs)(b(),{href:"/api/jobs/".concat(e.id,"/download"),className:"text-emerald-600 hover:text-emerald-800 ml-2",children:[(0,a.jsx)(o.a4x,{size:16,className:"inline mr-1"})," Download"]}),(0,a.jsxs)("button",{onClick:()=>g(e.id),className:"text-red-600 hover:text-red-800 ml-2 ".concat(t?"opacity-50 cursor-not-allowed":""),disabled:t||s||m,children:[(0,a.jsx)(o.IXo,{size:16,className:"inline mr-1 ".concat(t?"animate-spin":"")}),t?"Deleting...":"Delete"]}),"processing"===e.status&&!t&&(0,a.jsxs)("button",{onClick:()=>y(e.id),className:"text-blue-600 hover:text-blue-800 ml-2",disabled:s||t,children:[(0,a.jsx)(o.jTZ,{size:16,className:"inline mr-1 ".concat(s?"animate-spin":"")}),s?"Updating":"Update"]})]})})]},e.id)})})]})})]})};function p(){let{data:e,status:s}=(0,n.useSession)(),t=(0,l.useRouter)();return((0,r.useEffect)(()=>{"unauthenticated"===s&&t.push("/auth/signin")},[s,t]),"loading"===s)?(0,a.jsx)(h,{}):(0,a.jsx)(r.Suspense,{fallback:(0,a.jsx)(h,{}),children:(0,a.jsx)(u,{})})}},2227:(e,s,t)=>{Promise.resolve().then(t.bind(t,1709))}},e=>{var s=s=>e(e.s=s);e.O(0,[844,108,995,656,441,684,358],()=>s(2227)),_N_E=e.O()}]);